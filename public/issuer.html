<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Issuer Console</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color-scheme: light dark;
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: #0b0d12;
        color: #f8f9fc;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: radial-gradient(circle at top, rgba(88, 101, 242, 0.35), transparent),
          #05060a;
      }

      main {
        width: 100%;
        max-width: 720px;
        padding: 2.5rem 3rem;
        border-radius: 24px;
        background: rgba(15, 19, 32, 0.85);
        backdrop-filter: blur(14px);
        border: 1px solid rgba(120, 132, 255, 0.18);
        box-shadow: 0 32px 60px rgba(12, 16, 32, 0.45);
      }

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
      }

      h1 {
        margin: 0;
        font-size: 1.875rem;
        font-weight: 700;
        letter-spacing: -0.01em;
      }

      .subtitle {
        margin-top: 0.35rem;
        font-size: 0.95rem;
        color: #b6c2ff;
      }

      button {
        appearance: none;
        border: none;
        cursor: pointer;
        border-radius: 12px;
        padding: 0.9rem 1.6rem;
        font-size: 0.95rem;
        font-weight: 600;
        background: linear-gradient(135deg, #5865f2, #6c5ce7);
        color: #fff;
        box-shadow: 0 12px 24px rgba(104, 115, 255, 0.25);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      button:hover {
        transform: translateY(-1px);
        box-shadow: 0 16px 32px rgba(104, 115, 255, 0.35);
      }

      button:disabled {
        cursor: not-allowed;
        opacity: 0.55;
        box-shadow: none;
        transform: none;
      }

      form {
        display: grid;
        gap: 1.2rem;
      }

      .section-title {
        margin: 2.5rem 0 1rem;
        font-size: 1.1rem;
        font-weight: 600;
        color: #c6d2ff;
        letter-spacing: 0.02em;
      }

      .panel {
        margin-top: 1rem;
        padding: 1.8rem;
        border-radius: 20px;
        border: 1px solid rgba(118, 130, 255, 0.28);
        background: rgba(8, 11, 21, 0.85);
        display: grid;
        gap: 1.4rem;
      }

      .grid-two {
        display: grid;
        gap: 1rem;
        grid-template-columns: 1fr;
      }

      @media (min-width: 768px) {
        .grid-two {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }
      }

      .attributes-table {
        display: grid;
        gap: 0.9rem;
      }

      .attribute-row {
        display: grid;
        gap: 0.8rem;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        align-items: stretch;
      }

      .attribute-row input {
        padding: 0.85rem 1rem;
      }

      .attribute-actions {
        display: flex;
        gap: 0.6rem;
        margin-top: 0.6rem;
      }

      .secondary-button,
      .ghost-button {
        border: 1px solid rgba(115, 130, 255, 0.35);
        background: transparent;
        color: #c7d1ff;
        padding: 0.75rem 1.4rem;
        border-radius: 10px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: border-color 0.2s ease, background 0.2s ease;
      }

      .secondary-button:hover,
      .ghost-button:hover {
        border-color: rgba(140, 154, 255, 0.65);
        background: rgba(28, 35, 66, 0.6);
      }

      .ghost-button {
        border-style: dashed;
        justify-self: start;
      }

      .vc-output {
        font-family: "JetBrains Mono", "Fira Code", monospace;
        font-size: 0.92rem;
        background: rgba(5, 7, 17, 0.9);
        border-radius: 16px;
        padding: 1.2rem 1.1rem;
        color: #d1daff;
        border: 1px solid rgba(95, 108, 220, 0.3);
        max-height: 260px;
        overflow: auto;
        white-space: pre-wrap;
        word-break: break-word;
        overflow-wrap: anywhere;
      }

      .inline-actions {
        display: flex;
        justify-content: flex-end;
        gap: 0.8rem;
      }

      label {
        display: block;
        font-weight: 600;
        color: #d6dcff;
        margin-bottom: 0.4rem;
      }

      input, textarea {
        width: 100%;
        padding: 0.95rem 1.1rem;
        border-radius: 14px;
        border: 1px solid rgba(115, 130, 255, 0.25);
        background: rgba(10, 13, 25, 0.85);
        color: #f8f9fc;
        font-size: 0.95rem;
      }

      ::placeholder {
        color: rgba(197, 206, 255, 0.5);
      }

      .two-column {
        display: grid;
        gap: 1rem;
        grid-template-columns: 1fr;
      }

      @media (min-width: 768px) {
        .two-column {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }
      }

      .status-card {
        margin-top: 2.5rem;
        padding: 1.5rem;
        border-radius: 18px;
        border: 1px solid rgba(83, 95, 196, 0.35);
        background: rgba(8, 11, 21, 0.9);
        display: grid;
        gap: 0.6rem;
      }

      .status-card h2 {
        margin: 0;
        font-size: 1.05rem;
        letter-spacing: 0.02em;
        color: #bac7ff;
      }

      .status-value {
        font-family: "JetBrains Mono", "Fira Code", monospace;
        font-size: 0.95rem;
        word-break: break-word;
        color: #eef1ff;
      }

      .log {
        margin-top: 0.3rem;
        font-family: "JetBrains Mono", "Fira Code", monospace;
        font-size: 0.92rem;
        color: #9ba8ff;
        white-space: pre-wrap;
      }

      footer {
        margin-top: 2.5rem;
        font-size: 0.85rem;
        color: rgba(180, 190, 255, 0.6);
        text-align: center;
      }

      a {
        color: #8ea1ff;
      }

      @media (max-width: 640px) {
        main {
          padding: 2rem 1.4rem;
        }
        header {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }
        .grid-two, .two-column {
          grid-template-columns: 1fr;
        }
        .inline-actions {
          flex-direction: column;
          align-items: stretch;
        }
        .attribute-row {
          grid-template-columns: 1fr;
        }
        button, .secondary-button, .ghost-button {
          width: 100%;
        }
      }

      @media (max-width: 520px) {
        h1 { font-size: 1.55rem; }
        .section-title { margin-top: 2rem; }
        .panel { padding: 1.4rem 1.2rem; }
        .vc-output { max-height: 340px; }
      }
    </style>
  </head>
  <body>
    <main>
      <header>
        <div>
          <h1>Issuer Control Panel</h1>
          <p class="subtitle">
            Đăng ký DID Document lên blockchain và tạo Verifiable Credential (VC) đã ký cho Holder.
          </p>
        </div>
        <button id="connectWallet">Connect Wallet</button>
      </header>

      <h2 class="section-title">1. Đăng ký DID Document</h2>
      <form id="registerForm" class="panel">
        <div>
          <label for="contractAddress">Địa chỉ hợp đồng DIDRegistry</label>
          <input
            type="text"
            id="contractAddress"
            placeholder="0x..."
            autocomplete="off"
            required
          />
        </div>

        <div class="grid-two">
          <div>
            <label for="didInput">Issuer DID</label>
            <input
              type="text"
              id="didInput"
              placeholder="did:ethr:sepolia:0x..."
              autocomplete="off"
              required
            />
          </div>
          <div>
            <label for="cidInput">IPFS CID</label>
            <input
              type="text"
              id="cidInput"
              placeholder="bafy..."
              autocomplete="off"
              required
            />
          </div>
        </div>

        <button type="submit" id="registerBtn" disabled>Register Issuer Identity</button>
      </form>

      <h2 class="section-title">2. Tạo Verifiable Credential</h2>
      <section class="panel" id="vcPanel">
        <div class="grid-two">
          <div>
            <label for="holderDidInput">Holder DID</label>
            <input
              type="text"
              id="holderDidInput"
              placeholder="did:ethr:sepolia:0x..."
              autocomplete="off"
            />
          </div>
          <div>
            <label for="credentialTypeInput">Credential Type</label>
            <input
              type="text"
              id="credentialTypeInput"
              placeholder="vd: StudentCard"
              autocomplete="off"
              value="StudentCard"
            />
          </div>
        </div>

        <div>
          <label>Các thuộc tính cấp phát</label>
          <div class="attributes-table" id="attributeTable"></div>
          <button type="button" class="ghost-button" id="addAttributeBtn">+ Thêm thuộc tính</button>
        </div>

        <div class="inline-actions">
          <button type="button" class="secondary-button" id="resetAttributesBtn">Reset</button>
          <button type="button" id="createVcBtn" disabled>Create VC</button>
        </div>

        <div>
          <label>Kết quả VC (JWT)</label>
          <pre class="vc-output" id="vcOutput">Chưa tạo VC</pre>
        </div>
      </section>

      <section class="status-card">
        <h2>Wallet Status</h2>
        <div>
          <span>Account:</span>
          <div class="status-value" id="accountStatus">Chưa kết nối</div>
        </div>
        <div>
          <span>Network:</span>
          <div class="status-value" id="networkStatus">N/A</div>
        </div>
        <div>
          <span>Logs:</span>
          <div class="log" id="logArea">Chờ thao tác...</div>
        </div>
      </section>

      <footer>
        Sử dụng MetaMask hoặc ví tương thích EIP-1193. Nếu chưa có, truy cập
        <a href="https://metamask.io" target="_blank" rel="noreferrer">metamask.io</a>.
      </footer>
    </main>
    <script type="module" src="./assets/issuer.js"></script>
  </body>
</html>
